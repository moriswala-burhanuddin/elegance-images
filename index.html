<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaWorks Image Gallery</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .image-card:hover .overlay { opacity: 1; }
        .toast {
            animation: slideIn 0.3s ease-out forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div>
                <h1 class="text-3xl font-bold text-gray-800">NovaWorks Assets</h1>
                <p class="text-gray-500 mt-1">Static Image Hosting for Projects & Designs</p>
            </div>
            
            <div class="relative w-full md:w-96">
                <input type="text" id="searchInput" placeholder="Search images..." 
                    class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition shadow-sm">
                <svg class="w-5 h-5 absolute right-3 top-2.5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </div>
        </div>

        <!-- Grid -->
        <div id="gallery" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
            <!-- Loading State -->
            <div class="col-span-full text-center py-20 text-gray-500">
                Loading gallery...
            </div>
        </div>
        
        <!-- Empty State (Hidden) -->
        <div id="emptyState" class="hidden text-center py-20">
            <p class="text-gray-500 text-lg">No images found.</p>
            <p class="text-gray-400 text-sm mt-2">Add images to the <code>images/</code> folder and run <code>generate_gallery.py</code></p>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-5 right-5 bg-green-600 text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-24 opacity-0 transition-all duration-300 z-50 flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
        <span>Link copied!</span>
    </div>

    <script>
        const gallery = document.getElementById('gallery');
        const searchInput = document.getElementById('searchInput');
        const emptyState = document.getElementById('emptyState');
        const toast = document.getElementById('toast');
        let allImages = [];

        // Fetch Data
        fetch('images.json')
            .then(response => {
                if (!response.ok) throw new Error("Manifest not found");
                return response.json();
            })
            .then(data => {
                allImages = data;
                renderGallery(allImages);
            })
            .catch(err => {
                console.error(err);
                gallery.innerHTML = `
                    <div class="col-span-full text-center py-20 text-red-500 bg-white rounded-lg shadow">
                        <h3 class="font-bold text-xl">Gallery Index Not Found</h3>
                        <p class="mt-2">Please run <code class="bg-gray-100 px-2 py-1 rounded text-black">python generate_gallery.py</code> locally and push the changes.</p>
                    </div>
                `;
            });

        function renderGallery(images) {
            gallery.innerHTML = '';
            
            if (images.length === 0) {
                gallery.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }
            
            gallery.classList.remove('hidden');
            emptyState.classList.add('hidden');

            const baseUrl = window.location.origin + window.location.pathname.replace('index.html', '');

            images.forEach(img => {
                // Construct full absolute URL
                const fullUrl = `${baseUrl}${img.path}`;
                
                const card = document.createElement('div');
                card.className = "image-card group relative bg-white rounded-xl shadow-sm hover:shadow-md transition overflow-hidden border border-gray-100 aspect-square flex items-center justify-center bg-gray-50";
                
                card.innerHTML = `
                    <img src="${img.path}" alt="${img.name}" loading="lazy" class="w-full h-full object-contain p-2">
                    
                    <!-- Overlay -->
                    <div class="overlay absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex flex-col items-center justify-center gap-3 p-4">
                        <p class="text-white text-xs font-mono truncate w-full text-center px-2">${img.name}</p>
                        
                        <button onclick="copyToClipboard('${fullUrl}')" 
                            class="bg-white text-gray-900 px-4 py-2 rounded-full font-medium text-sm hover:bg-gray-100 transform hover:scale-105 transition flex items-center gap-2">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                            Copy URL to Clipboard
                        </button>
                        
                        <a href="${fullUrl}" target="_blank" class="text-gray-300 text-xs hover:text-white underline">Open Image</a>
                    </div>
                    
                    <div class="absolute bottom-0 left-0 right-0 bg-white/90 backdrop-blur px-3 py-2 text-xs text-gray-600 border-t border-gray-100 truncate group-hover:opacity-0 transition">
                        ${img.name}
                    </div>
                `;
                
                gallery.appendChild(card);
            });
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast();
            });
        }

        function showToast() {
            toast.classList.remove('translate-y-24', 'opacity-0');
            setTimeout(() => {
                toast.classList.add('translate-y-24', 'opacity-0');
            }, 2000);
        }

        // Search Filter
        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = allImages.filter(img => img.name.toLowerCase().includes(term));
            renderGallery(filtered);
        });
    </script>
</body>
</html>
